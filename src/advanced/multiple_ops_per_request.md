# 1回のリクエストで複数の操作を行う

GraphQL標準では、一般に、実行したいクライアント操作（クエリーやミューテーションなど）ごとに1回のサーバーリクエストがあることを想定しています。これは概念的には単純ですが、非効率になる可能性があります。

[apollo-link-batch-http](https://www.apollographql.com/docs/link/links/batch-http.html)のようないくつかのクライアントライブラリは、1つのHTTPリクエストでバッチ処理を行う機能を追加し、ネットワークのラウンドトリップを節約し、パフォーマンスを向上させる可能性を持っています。リクエストをバッチ処理する前に考慮すべきいくつかの [トレードオフ](https://blog.apollographql.com/batching-client-graphql-queries-a685f5bcd41b) があります。

Juniperのサーバー統合クレートは、JSON配列を使用して、1つのHTTPリクエストで複数の操作をサポートしています。このため、特別な設定なしにバッチ処理をサポートするクライアントライブラリとの互換性があります。

他社が保守するサーバー統合クレートは、バッチ要求をサポートする必要はありません。バッチリクエストは公式のGraphQL仕様の一部ではありません。

統合がバッチリクエストをサポートしていると仮定して、以下のようなGraphQLクエリについて。

```graphql
{
  hero {
    name
  }
}
```

個々のリクエストに対してサーバーにPOSTするjsonデータは、次のようになります。

```json
{
  "query": "{hero{name}}"
}
```

そしてその応答は、このような形になります。

```json
{
  "data": {
    "hero": {
      "name": "R2-D2"
    }
  }
}
```

1回のHTTPリクエストで同じクエリを2回実行したい場合、サーバーにPOSTするjsonデータのバッチは次のようになります。

```json
[
  {
    "query": "{hero{name}}"
  },
  {
    "query": "{hero{name}}"
  }
]
```

そしてその応答は、このような形になります。

```json
[
  {
    "data": {
      "hero": {
        "name": "R2-D2"
      }
    }
  },
  {
    "data": {
      "hero": {
        "name": "R2-D2"
      }
    }
  }
]
```